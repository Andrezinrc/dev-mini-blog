{
  "frontmatter": {
    "id": "post_1762367228791",
    "title": "Desenvolvendo um Scanner de Antivírus em C",
    "description": "Conheça meu projeto de scanner de antivírus desenvolvido em C com detecção por assinatura e suporte a EICAR",
    "author": "André Moreira",
    "github": "Andrezinrc",
    "date": "2025-11-22",
    "image": "/assets/images/posts/scanner-antivirus-c/illustration.jpeg",
    "category": "projetos",
    "tags": ["c", "segurança", "antivirus", "programação", "scanner"],
    "published": true
  },
  "content": "# Desenvolvendo um Scanner de Antivírus em C\n\nEstou desenvolvendo um scanner de antivírus em C como projeto para aprender mais sobre segurança cibernética e detecção de malwares. O projeto utiliza detecção por assinatura para identificar ameaças conhecidas.\n\n## Como funciona\n\nO scanner analisa arquivos procurando por padrões específicos (assinaturas) que identificam malware. A implementação inclui:\n\n- **Sistema de regras**: Carrega assinaturas de malware de um arquivo de configuração\n- **Detecção EICAR**: Suporte ao arquivo de teste padrão da indústria\n- **Scanner recursivo**: Varre diretórios completos de forma eficiente\n- **Filtros inteligentes**: Ignora diretórios desnecessários e foca em extensões suspeitas\n\n## Características principais\n\n```c\n// Exemplo de assinatura EICAR para testes\nuint8_t eicar_signature[EICAR_SIZE] = {\n    0x58,0x35,0x4F,0x21,0x50,0x25,0x40,0x41,\n    // ... padrão completo do EICAR\n};\n```\n\n### Funcionalidades implementadas\n\n- **Carregamento dinâmico de regras**: Suporte a múltiplas assinaturas de malware\n- **Otimização de performance**: Leitura em chunks com overlap para detectar padrões que cruzam blocos\n- **Diretórios ignorados**: Evita scanear node_modules, .git, e outras pastas irrelevantes\n- **Extensões focadas**: Analisa apenas arquivos com extensões potencialmente perigosas\n\n## Estrutura do projeto\n\nO scanner é organizado em funções especializadas:\n\n- `load_signatures()` - Carrega regras de detecção\n- `scan_file_rules()` - Analisa arquivo individual\n- `scan_directory()` - Varre diretórios recursivamente\n- `should_scan_file()` - Filtra extensões relevantes\n\n## Próximos passos\n\nEstou planejando adicionar:\n\n- Suporte a arquivos compactados (ZIP, RAR)\n- Detecção heurística básica\n- Logging mais detalhado\n- Interface de linha de comando mais amigável\n\n## Testando o scanner\n\nO projeto inclui um sistema de testes com arquivos de exemplo, incluindo o padrão EICAR para validação do funcionamento.\n\nÉ um projeto em andamento que tem sido excelente para aprender sobre baixo nível, segurança e processamento de arquivos em C!\n\n---\n\n*O código completo está disponível no meu GitHub. Contribuições e sugestões são bem-vindas!*",
  "slug": "scanner-antivirus-c"
}